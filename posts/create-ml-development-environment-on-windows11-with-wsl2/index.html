<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Create Machine Learning Development Environment on Windows 11 With WSL 2 | Visionbike - Personal Blog of CV | DSP | ML notes</title><meta name=keywords content><meta name=description content="To get started with running CUDA on WSL, you need to instal NVIDIA Driver on Windows 11 with a compatible GeForce or NVIDIA RTX/Quadro card from this link.
Note that you only need to install NVIDIA Driver for Windows. Do not install any Linux Driver in WSL.
The latest NVIDIA Windows GPU Driver will fully support WSL 2. With CUDA support in the driver, existing applications compiled on a Linux system for the same target GPU can run unmodified within the WSL environment."><meta name=author content="Visionbike"><link rel=canonical href=http://visionbike.github.io/posts/create-ml-development-environment-on-windows11-with-wsl2/><link crossorigin=anonymous href=/assets/css/stylesheet.min.77f72eb252297452dcd66ab556630cc6e7e244a2659c39206e3d7c3dd9152a30.css integrity="sha256-d/cuslIpdFLc1mq1VmMMxufiRKJlnDkgbj18PdkVKjA=" rel="preload stylesheet" as=style><link rel=icon type=image/png href=/images/favicon.ico><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><meta name=twitter:title content="Create Machine Learning Development Environment on Windows 11 With WSL 2 | Visionbike - Personal Blog of CV | DSP | ML notes"><meta name=twitter:description content="To get started with running CUDA on WSL, you need to instal NVIDIA Driver on Windows 11 with a compatible GeForce or NVIDIA RTX/Quadro card from this link.
Note that you only need to install NVIDIA Driver for Windows. Do not install any Linux Driver in WSL.
The latest NVIDIA Windows GPU Driver will fully support WSL 2. With CUDA support in the driver, existing applications compiled on a Linux system for the same target GPU can run unmodified within the WSL environment."><meta property="og:title" content="Create Machine Learning Development Environment on Windows 11 With WSL 2 | Visionbike - Personal Blog of CV | DSP | ML notes"><meta property="og:description" content="To get started with running CUDA on WSL, you need to instal NVIDIA Driver on Windows 11 with a compatible GeForce or NVIDIA RTX/Quadro card from this link.
Note that you only need to install NVIDIA Driver for Windows. Do not install any Linux Driver in WSL.
The latest NVIDIA Windows GPU Driver will fully support WSL 2. With CUDA support in the driver, existing applications compiled on a Linux system for the same target GPU can run unmodified within the WSL environment."><meta property="og:type" content="article"><meta property="og:url" content="http://visionbike.github.io/posts/create-ml-development-environment-on-windows11-with-wsl2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-13T16:44:33+08:00"><meta property="article:modified_time" content="2023-07-13T16:44:33+08:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://visionbike.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Create Machine Learning Development Environment on Windows 11 With WSL 2","item":"http://visionbike.github.io/posts/create-ml-development-environment-on-windows11-with-wsl2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Create Machine Learning Development Environment on Windows 11 With WSL 2 | Visionbike - Personal Blog of CV | DSP | ML notes","name":"Create Machine Learning Development Environment on Windows 11 With WSL 2","description":"To get started with running CUDA on WSL, you need to instal NVIDIA Driver on Windows 11 with a compatible GeForce or NVIDIA RTX/Quadro card from this link.\nNote that you only need to install NVIDIA Driver for Windows. Do not install any Linux Driver in WSL.\nThe latest NVIDIA Windows GPU Driver will fully support WSL 2. With CUDA support in the driver, existing applications compiled on a Linux system for the same target GPU can run unmodified within the WSL environment.","keywords":[],"wordCount":"752","inLanguage":"en","datePublished":"2023-07-13T16:44:33+08:00","dateModified":"2023-07-13T16:44:33+08:00","author":{"@type":"Person","name":"Visionbike"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://visionbike.github.io/posts/create-ml-development-environment-on-windows11-with-wsl2/"},"publisher":{"@type":"Organization","name":"Visionbike - Personal Blog of CV | DSP | ML notes","logo":{"@type":"ImageObject","url":"http://visionbike.github.io/favicon.ico"}}}</script><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=lib/fontawesome-free/all.min.css></head><body class="dark type-posts kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="dark",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=http://visionbike.github.io/ accesskey=h title="Visionbike (Alt + H)"><img src=http://visionbike.github.io/images/apple-touch-icon.png alt=logo aria-label=logo height=35 width=35>Visionbike</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=http://visionbike.github.io/posts/ title=Posts class=active>Posts</a></li><li><a href=http://visionbike.github.io/tags/ title=Tags>Tags</a></li><li><a href=http://visionbike.github.io/archives/ title=Archive>Archive</a></li><li><a href=http://visionbike.github.io/publish/ title=Publish>Publish</a></li><li><a href=http://visionbike.github.io/about/ title=About>About</a></li><li><a href=http://visionbike.github.io/search/ title="Search (Alt + /)" data-no-instant accesskey=/>Search</a></li></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://visionbike.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=http://visionbike.github.io/posts/>Posts</a></div><h1 class=post-title>Create Machine Learning Development Environment on Windows 11 With WSL 2</h1><div class=post-meta><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>July 13, 2023</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg>
<span>752 words</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>4 min</span></span></div></header><div class="toc side right"><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-install-nvidia-cuda-toolkit-for-wsl-2 aria-label="1. Install NVIDIA CUDA Toolkit for WSL 2">1. Install NVIDIA CUDA Toolkit for WSL 2</a></li><li><a href=#2-install-nvidia-cudnn aria-label="2. Install NVIDIA CuDNN">2. Install NVIDIA CuDNN</a></li><li><a href=#3-set-up-python-environment-using-mambaforge aria-label="3. Set up Python environment using Mambaforge">3. Set up Python environment using Mambaforge</a><ul><li><a href=#create-and-use-virtual-environments aria-label="Create and use virtual environments">Create and use virtual environments</a></li><li><a href=#working-with-python-packages aria-label="Working with Python packages">Working with Python packages</a></li></ul></li><li><a href=#reference aria-label=Reference>Reference</a></li></ul></div></details></div><div class=post-content><p>To get started with running CUDA on WSL, you need to instal NVIDIA Driver on Windows 11 with a compatible GeForce or NVIDIA RTX/Quadro card from this <a href=https://www.nvidia.com/Download/index.aspx>link</a>.</p><p>Note that you <strong>only need to install NVIDIA Driver for Windows. Do not install any Linux Driver in WSL</strong>.</p><p>The latest NVIDIA Windows GPU Driver will fully support WSL 2. With CUDA support in the driver, existing applications compiled on a Linux system for the same target GPU can run unmodified within the WSL environment. Once NVIDIA Windows GPU Driver is installed in the system, the CUDA driver will be stubbed inside the WSL 2 as <code>libcuda.so</code>. Therefore, you only use a separate CUDA Toolkit for WSL 2 which does not contain the NVIDIA Linux GPU Driver.</p><h2 id=1-install-nvidia-cuda-toolkit-for-wsl-2>1. Install NVIDIA CUDA Toolkit for WSL 2<a hidden class=anchor aria-hidden=true href=#1-install-nvidia-cuda-toolkit-for-wsl-2>Â¶</a></h2><p>First remove the old GPG key from your WSL machine</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>sudo apt-key del 7fa2af80
</span></span></span></code></pre></div><p>Download <a href="https://developer.nvidia.com/cuda-downloads?target_os=Linux&amp;target_arch=x86_64&amp;Distribution=WSL-Ubuntu&amp;target_version=2.0&amp;target_type=deb_local">CUDA Toolkit for WSL 2</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>wget https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-wsl-ubuntu.pin
</span></span></span><span class=line><span class=cl><span class=go>sudo mv cuda-wsl-ubuntu.pin /etc/apt/preferences.d/cuda-repository-pin-600
</span></span></span><span class=line><span class=cl><span class=go>wget https://developer.download.nvidia.com/compute/cuda/12.2.1/local_installers/cuda-repo-wsl-ubuntu-12-2-local_12.2.1-1_amd64.deb
</span></span></span></code></pre></div><p>Then, folow the installation instruction.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>sudo dpkg -i cuda-repo-wsl-ubuntu-12-2-local_12.2.1-1_amd64.deb
</span></span></span><span class=line><span class=cl><span class=go>sudo cp /var/cuda-repo-wsl-ubuntu-12-2-local/cuda-*-keyring.gpg /usr/share/keyrings/
</span></span></span><span class=line><span class=cl><span class=go>sudo apt-get update
</span></span></span><span class=line><span class=cl><span class=go>sudo apt-get -y install cuda
</span></span></span></code></pre></div><p>Verify that CUDA is successfully installed by command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>nvidia-smi
</span></span></span></code></pre></div><h2 id=2-install-nvidia-cudnn>2. Install NVIDIA CuDNN<a hidden class=anchor aria-hidden=true href=#2-install-nvidia-cudnn>Â¶</a></h2><p>You can find the coresponding installation file from <a href=https://developer.nvidia.com/rdp/cudnn-archive>this</a>. Here you need to register and login to download it.</p><p><img loading=lazy src=/posts/create-ml-development-environment-on-windows11-with-wsl2/cudnn-download.png type alt="CuDNN download"></p><p>You can use Windows to download installation files then move to Ubuntu system in WSL 2. The WSL system is mapped to <code>\\wsl$\Ubuntu-22.04</code> and Windows drives are mounted under <code>/mnt</code> and can be accessed directly.</p><p>Once completed, it can be installed with following commands</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>sudo dpkg -i cudnn-local-repo-ubuntu2204-8.9.3.28_1.0-1_amd64.deb
</span></span></span><span class=line><span class=cl><span class=go>sudo cp /var/cudnn-local-repo-ubuntu2204-8.9.3.28/cudnn-local-*-keyring.gpg /usr/share/keyrings/
</span></span></span><span class=line><span class=cl><span class=go>sudo apt-get -y update
</span></span></span><span class=line><span class=cl><span class=go>sudo apt-get -y upgrade
</span></span></span></code></pre></div><details class="admonition tip"><summary class=admonition-title>Fix "libcuda.so.1 is not a symbolic link" error</summary><p>Once the installattion is completed, you may receive the following error:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/sbin/ldconfig.real: /usr/lib/wsl/lib/libcuda.so.1 is not a symbolic link
</span></span></code></pre></div><p>The reason may be the property of read-only of the directory. You can create other directory then link executable from <code>/usr/lib/wsl/lib/</code> to the new directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>cd /usr/lib/wsl
</span></span></span><span class=line><span class=cl><span class=go>sudo mkdir lib2
</span></span></span><span class=line><span class=cl><span class=go>sudo ln -s lib/* lib2
</span></span></span><span class=line><span class=cl><span class=go>sudo ldconfig
</span></span></span></code></pre></div><p>Then change <code>/usr/lib/wsl/lib</code> in the file <code>/etc/ld.so.conf.d/ld.wsl.conf</code> to <code>/usr/lib/wsl/lib2</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:</span>
</span></span><span class=line><span class=cl><span class=c1>#[automount]</span>
</span></span><span class=line><span class=cl><span class=c1>#ldconfig = false</span>
</span></span><span class=line><span class=cl>/usr/lib/wsl/lib2
</span></span></code></pre></div><p>Restarting WSL after setting will automatically restore, if you donât want to restore, you need to modif <code>/etc/wsl.conf</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>automount<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>ldconfig</span> <span class=o>=</span> <span class=nb>false</span>
</span></span></code></pre></div></details><h2 id=3-set-up-python-environment-using-mambaforge>3. Set up Python environment using Mambaforge<a hidden class=anchor aria-hidden=true href=#3-set-up-python-environment-using-mambaforge>Â¶</a></h2><p>Python environment allows to manage separatelly different installations of Python and modules. It is useful when you have many projects running different version of Python and modules. It also help to manage installed modules for publish or reproduce.</p><p>There are different ways to create a python virtual environment, including built-in <code>venv</code>, <code>Conda</code> and <code>Anaconda</code>.</p><p><code>Conda</code> is a packaging tool and installer that aims to handle library dependencies outside of the Python packages as well as the Python packages themselves. For non preinstalled package manager, <code>Miniconda</code>, an installation of Conda, will be a good option.</p><p><code>Anacond</code>a is an installation of Conda that comes pre-loaded with a bunch of packages for scientific computing, i.e., <code>numpy</code>, <code>matplotlib</code>, <code>scipy</code>, etc. It also comes with IDE, Jupyter notebooks out of the box. This is helpful for beginers, but doesn&rsquo;t give much control.</p><p><code>Mamba</code> is a package manager which can be used with Python. Unlike <code>Conda</code>, it uses the C/C++ implementation to speed up the package installation. Read more about <code>mamba</code> in <a href=https://focalplane.biologists.com/2022/12/08/managing-scientific-python-environments-using-conda-mamba-and-friends/>here</a>. To install <code>mamba</code>, access <a href=https://github.com/conda-forge/miniforge>its repo</a> and pick the Mabaforge installer for your operating system.</p><p>Remember to run <code>conda init</code> at the end of your installation in your console to activate the <code>mamba</code> command.</p><p><img loading=lazy src=/posts/create-ml-development-environment-on-windows11-with-wsl2/mambaforge-install.png type alt="Mambaforge install"></p><h3 id=create-and-use-virtual-environments>Create and use virtual environments<a hidden class=anchor aria-hidden=true href=#create-and-use-virtual-environments>Â¶</a></h3><p>The command using <code>mamba</code> is similar to the <code>conda</code> command.</p><ul><li>Create new environment</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>mamba create -n &lt;envname&gt; python=&lt;version&gt;
</span></span></span></code></pre></div><ul><li>Activate an environment</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>mamba activate &lt;envname&gt;
</span></span></span></code></pre></div><ul><li>Deactivate environment</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>mamba deactivate
</span></span></span></code></pre></div><ul><li>Delete an environment</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>mamba env remove -n &lt;envname&gt;
</span></span></span></code></pre></div><ul><li>Show all created environments</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>mamba env list
</span></span></span></code></pre></div><h3 id=working-with-python-packages>Working with Python packages<a hidden class=anchor aria-hidden=true href=#working-with-python-packages>Â¶</a></h3><p><strong>Remember to activate an environment first, do not install any packages in your base environment!</strong></p><ul><li>Install python packages</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>mamba install &lt;package&gt;[=version] [-c &lt;channelname&gt;]
</span></span></span></code></pre></div><p>When installing a package, you can optionally indicate specific additional channel that the packages are posted by community. <code>conda-forge</code> is one of most common additional channels.</p><ul><li>Delete packages</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>mamba remove &lt;package&gt;
</span></span></span></code></pre></div><ul><li>Show all installed packages in the virtual environment</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>mamaba list [-n &lt;envname&gt;]
</span></span></span></code></pre></div><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>Â¶</a></h2><ul><li><a href=https://medium.com/geekculture/install-cuda-and-cudnn-on-windows-linux-52d1501a8805>Install CUDA and CUDNN on Windows & Linux</a>.</li><li><a href=https://docs.nvidia.com/cuda/wsl-user-guide/index.html>CUDA on WSL User Guide</a>.</li><li><a href=https://visualstudio.microsoft.com/free-developer-offers/>Machine learning environment build: WLS2+Ubuntu+CUDA+cuDNN</a>.</li><li><a href=https://biapol.github.io/blog/mara_lampert/getting_started_with_mambaforge_and_python/readme.html>Getting started with Mambaforge and Python</a>.</li><li><a href=https://ross-dobson.github.io/posts/2021/01/setting-up-python-virtual-environments-with-mambaforge/>Tutorial: Setting up Python enviroments with Mambaforge</a>.</li></ul></div><footer class=post-footer><nav class=paginav><a class=next href=http://visionbike.github.io/posts/working-with-wsl2-on-windows11/><span class=title>Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span><br><span>Working With Windows Subsystem for Linux 2 on Windows 11</span></a></nav></footer><div class=comments-separator></div></article></main><footer class=footer><span>&copy; 2023 <a href=http://visionbike.github.io/>Visionbike - Personal Blog of CV | DSP | ML notes</a></span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a></span>
<span style=display:inline-block;margin-left:1em>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>(function(){const t="1"=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n="1"=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script>
<script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a="1"=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script><script>mediumZoom(".entry-cover img"),mediumZoom(".post-content img:not([no-zoom])")</script><script src=/js/instantclick.min.js data-no-instant></script>
<script data-no-instant>InstantClick.init()</script></body></html>